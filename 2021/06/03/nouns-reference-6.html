<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>名词解释 - AOP, OOP, POP | </title><meta name="author" content="pilotqvq"><meta name="copyright" content="pilotqvq"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="AOP, OOP, POPPOP: 注重功能性的实现，效果达到就好了 OOP: 注重封装，强调整体性的概念，将对象的内部组织与外部环境区分开来。 AOP： Aop 可以实现如事务，缓存，权限验证的功能。 复用代码：1. 继承的方式（纵向扩展）2. 组合&#x2F;聚合（横向扩展，这就是AOP）  We may often see a particular lines of code becomes bigg">
<meta property="og:type" content="article">
<meta property="og:title" content="名词解释 - AOP, OOP, POP">
<meta property="og:url" content="https://c-parrot.github.io/2021/06/03/nouns-reference-6">
<meta property="og:site_name">
<meta property="og:description" content="AOP, OOP, POPPOP: 注重功能性的实现，效果达到就好了 OOP: 注重封装，强调整体性的概念，将对象的内部组织与外部环境区分开来。 AOP： Aop 可以实现如事务，缓存，权限验证的功能。 复用代码：1. 继承的方式（纵向扩展）2. 组合&#x2F;聚合（横向扩展，这就是AOP）  We may often see a particular lines of code becomes bigg">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/名词解释/TIM截图20190412213930.png">
<meta property="article:published_time" content="2021-06-03T09:24:16.000Z">
<meta property="article:modified_time" content="2021-12-26T05:40:15.768Z">
<meta property="article:author" content="pilotqvq">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/名词解释/TIM截图20190412213930.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://c-parrot.github.io/2021/06/03/nouns-reference-6"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"HPFFJ9C6DB","apiKey":"78e3e87b096c5c0bff76287be921d775","indexName":"pilotqvq","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '名词解释 - AOP, OOP, POP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-26 13:40:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/hexo相关/无职转生.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">39</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">名词解释 - AOP, OOP, POP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">Updated</span><time datetime="2021-12-26T05:40:15.768Z" title="undefined 2021-12-26 13:40:15">2021-12-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">1.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>4min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="名词解释 - AOP, OOP, POP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="AOP-OOP-POP"><a href="#AOP-OOP-POP" class="headerlink" title="AOP, OOP, POP"></a>AOP, OOP, POP</h1><p>POP: 注重功能性的实现，效果达到就好了</p>
<p>OOP: 注重封装，强调整体性的概念，将对象的内部组织与外部环境区分开来。</p>
<p>AOP： Aop 可以实现如事务，缓存，权限验证的功能。</p>
<p>复用代码：1. 继承的方式（纵向扩展）2. 组合/聚合（横向扩展，这就是AOP）</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image013.png"></p>
<p>We may often see a particular lines of code becomes bigger as it grows, even up to the point where it becomes harder to understand its original business logic because the code already cluttered with other things, such as logging, authorization, validation, performance checker, etc.</p>
<p><strong>但是</strong>随着软件开发的系统越来越复杂，工程师认识到，传统的OOP程序经常表现出一些不自然的现象，核心业务中总掺杂着一些不相关联的特殊业务，如<strong>日志记录，权限验证，事务控制，性能检测，错误信息检测</strong>等等，这些特殊业务可以说和核心业务没有根本上的关联而且核心业务也不关心它们。这样就会造成如下问题：</p>
<p>代码混乱：核心业务模块可能需要兼顾处理其他不相干的业务外围操作，这些外围操作可能会混乱核心操作的代码，而且当外围模块有重大修改时也会影响到核心模块，这显然是不合理的。</p>
<p>代码分散和冗余：同样的功能代码，在其他的模块几乎随处可见，导致代码分散并且冗余度高。</p>
<p>代码质量低扩展难：由于不太相关的业务代码混杂在一起，无法专注核心业务代码，当进行类似无关业务扩展时又会直接涉及到核心业务的代码，导致拓展性低。</p>
<p>显然前面分析的<strong>两种解决方案已束手无策了</strong>？，那么该如何解决呢？事实上我们知道诸如日志，权限，事务，性能监测等业务几乎涉及到了所有的核心模块，如果把这些特殊的业务代码直接到核心业务模块的代码中就会造成上述的问题，而工程师更希望的是这些模块可以实现热插拔特性而且无需把外围的代码入侵到核心模块中，这样在日后的维护和扩展也将会有更佳的表现，假设现在我们把日志、权限、事务、性能监测等外围业务看作单独的关注点(也可以理解为单独的模块)，每个关注点都可以在需要它们的时刻及时被运用而且无需提前整合到核心模块中，这种形式相当下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image014.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image015.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image016.png"></p>
<p>每个关注点与核心业务模块分离，每份功能代码不再单独入侵到核心业务类的代码中。</p>
<p>这些外围业务会通过一种特殊的技术自动应用到核心模块中</p>
<p>adding additional behavior to existing code (an advice) without modifying the code itself</p>
<p>这些关注点有个特殊的名称，叫做“横切关注点”，上图也很好的表现出这个概念，另外这种抽象级别的技术也叫<strong>AOP（面向切面编程）</strong></p>
<p>AOP面向切面编程(Aspect Oriented Programming)是通过<strong>预编译方式和运行期动态代理</strong>实现<strong>程序功能的统一维护</strong>的一种技术。</p>
<p>AOP的<strong>本质是通过代理对象来间接执行真实对象</strong>，在代理类中往往会<strong>添加装饰一些额外的业务代码</strong>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image017.png"></p>
<p>想在<strong>设置属性前后</strong>及<strong>调用方法前后</strong>或<strong>报错</strong>都能收集日志信息，将原有的真实类RealA委托给代理类ProxyRealA来执行，</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image018.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image019.png"></p>
<p>拦截点（或者称为：横切面，切面点）一般主要为：<strong>执行前，执行后，发生错误</strong>，</p>
<p>好处：核心代码部分在基类中，只专注于核心代码</p>
<p>新问题又来了，那就是<strong>当一个系统中的类非常多的时候</strong>，如果我们针对每个类都定义一个代理类，那么系统的<strong>类的个数会成倍增加，而且不同的代理类中可能某些拦截业务逻辑代码都是相同的</strong>，</p>
<p>几种常见的实现AOP的方式：</p>
<p>一种是编译时静态植入，优点是效率高，缺点是缺乏灵活性，.net下postsharp为代表者（好像是付费了。。）。</p>
<p>另一种方式是动态代理，优点是灵活性强，但是会影响部分效率，动态为目标类型创建代理，通过代理调用实现拦截。</p>
<h3 id="第一种：静态织入"><a href="#第一种：静态织入" class="headerlink" title="第一种：静态织入"></a>第一种：静态织入</h3><p>编译器将代码注入到拦截点</p>
<p>PostSharp:PostSharp的Aspect是使用<strong>Attribute</strong>实现的。</p>
<p>我们只需事先通过继承自<strong>OnMethodBoundaryAspect</strong>，然后重写几个常见的方法即可，如：OnEntry，OnExit等，最后只需要在需要进行AOP拦截的属性或方法上加上AOP拦截特性类即可。</p>
<p>由于PostSharp是静态织入的，所以相比其它的通过反射或EMIT反射来说效率是最高的，但PostSharp是收费版本的，而且网上的教程比较多，我就不在此重复说明了。</p>
<h3 id="第二种：EMIT反射"><a href="#第二种：EMIT反射" class="headerlink" title="第二种：EMIT反射"></a>第二种：EMIT反射</h3><p>Emit反射动态生成代理类</p>
<p>如下<code>Castle.DynamicProxy</code>的AOP实现方式，代码也还是比较简单的，效率相对第一种要慢一点，但对于普通的反射来说又高一些</p>
<h1 id="A-command-line-interface-CLI"><a href="#A-command-line-interface-CLI" class="headerlink" title="A command-line interface (CLI)"></a>A command-line interface (CLI)</h1><h1 id="Autofac"><a href="#Autofac" class="headerlink" title="Autofac"></a>Autofac</h1><p>相关术语：</p>
<p><strong>组件</strong>：理解为容器内的基本单元,每个组件都有自己的信息：比如暴露的服务类型、生命周期域、绑定的具象对象等。</p>
<p><strong>服务</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image020.png">                               </p>
<p> 不需要一个一个注册的，运用批量注册后容器内部的代码是这样的，可以直接批量注册所有的</p>
<p>注册方式</p>
<p>泛型注册：</p>
<p>builder.RegisterType<Class_1>();</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image021.png"></p>
<p>Lambda注册：</p>
<p><img src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/image022.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">pilotqvq</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://c-parrot.github.io/2021/06/03/nouns-reference-6">https://c-parrot.github.io/2021/06/03/nouns-reference-6</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/名词解释/TIM截图20190412213930.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/03/nouns-reference-3"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/名词解释/TIM截图20190412213930.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">名词解释 - 仓储模式与DAO</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/03/nouns-reference-5"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/c-parrot/source/img/blog/名词解释/TIM截图20190412213930.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">名词解释 - SPA与MPA</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP-OOP-POP"><span class="toc-number">1.</span> <span class="toc-text">AOP, OOP, POP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%9A%E9%9D%99%E6%80%81%E7%BB%87%E5%85%A5"><span class="toc-number">1.0.1.</span> <span class="toc-text">第一种：静态织入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%9AEMIT%E5%8F%8D%E5%B0%84"><span class="toc-number">1.0.2.</span> <span class="toc-text">第二种：EMIT反射</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A-command-line-interface-CLI"><span class="toc-number">2.</span> <span class="toc-text">A command-line interface (CLI)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Autofac"><span class="toc-number">3.</span> <span class="toc-text">Autofac</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By pilotqvq</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'e53a0a1cfef738bdcf12',
      clientSecret: '78d3614c9635daf100666db51131822370f2fa50',
      repo: 'C-Parrot.github.io',
      owner: 'c-parrot',
      admin: ['c-parrot'],
      id: '85c440c9ef0869b623269b650032b6f0',
      language: 'en',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><!-- hexo injector body_end end --></body></html>